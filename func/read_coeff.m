function [C, S, GM, R, n]=read_coeff(fid)% read potential field coefficients from .gfc file% input:  fid file id of data file% output: C,S potential field coefficients Clm and Slm%         GM  Earth grvavity constant%         R   Earth Radius in m %         n   maximum degree of spherical harmonic coefficient%% Headerwhile 1  tline=fgetl(fid);  if strncmp('earth_gravity_constant',tline,10)    GM=strread(tline,'%*s %f');  elseif strncmp('radius',tline,5)    R=strread(tline,'%*s %f');  elseif strncmp('max_degree',tline,8)    n=strread(tline,'%*s %f');  elseif strncmp('end_of_head',tline,10)    break  endend%% Datadata=textscan(fid,'%*s %f %f %f %f %f %f ');data=cell2mat(data);%% write data to n+1 x n+1 matrixS=zeros(n+1,n+1);C=S;for hi=1:length(data)  C(data(hi,1)+1,data(hi,2)+1)=data(hi,3);  S(data(hi,1)+1,data(hi,2)+1)=data(hi,4);endend