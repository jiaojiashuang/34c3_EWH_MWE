function erg=equiv_water_height(C,S,GC,P,n,lambda,theta,rho_E,rho_w,R)% Calculation of equivalent water height% Input: C,S  Spherical harmonic coefficients%        GC   Gaussian Filter Coefficients%        P    normalized Legendre Functions%      lambda Longitude of calculation point in radians%       theta Co-latitude of calculation point in radians%       rho_E average density of Earth%       rho_w average density of water%        R    Radius Earth% Output  erg EWH%% References:% Wahr, J., Molenaar, M., Bryan, F. (1998): Time variability of the Earth's % gravity field: Hydrological and oceanic effects and their possible detection % using GRACE, J. Geophys. Res., 103(B12), 30205â€“30229, DOI: 10.1029/98JB02844.persistent kn% Love Numbersif isempty(kn)  kn=lovenumbers;enderg=0;for L=2:n % Degree  indL=L+1;  fak1=(2*L+1)/(1+kn(indL));  sum1=0;  for M=0:L % order    indM=M+1;    sum1=sum1+...        ( GC(indL)*C(indL,indM)*cos(M*lambda) + GC(indL)*S(indL,indM)*sin(M*lambda) )*P(indL,indM);  end  erg=erg+fak1*sum1;enderg=R*rho_E/(3*rho_w)*erg;  endfunction ki=lovenumbers% Interpolate Love Numbers for PREM Earth Model, after% Wahr, J. (2007): Time Variable Gravity Fields from Satellites. In: Herring, % T.A. (Ed.): Treatise on Geophysics, Vol 3.kl=[2 -0.3033 -0.1944 -0.1325 -0.1046 -0.0897 -0.0818 -0.0769 -0.07210 -0.06912 -0.064 15 -0.058 20 -0.051 30 -0.040 40 -0.033 50 -0.027 70 -0.020 100 -0.014 150 -0.010200 -0.007];ki=[0 0 interp1(kl(:,1),kl(:,2),2:125,'cubic')]';end